TODO:
  * add file permission checking
